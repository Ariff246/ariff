using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;
using UnityEngine.SceneManagement;
using UnityEngine.Networking;

public class UserProperty
{
    public string idpengguna;
}

public class LoginController : MonoBehaviour
{

    public InputField idpengguna;

    public string Url;

    void Start()
    {

    }

    public void OnButtonDaftar()
    {
        SceneManager.LoadScene(2);
    }

    public void PerformLogin()
    {
        StartCoroutine(login());
    }   

    IEnumerator login()
    {
        WWWForm loginForm = new WWWForm();
        loginForm.AddField("email", idpengguna.text);

        UnityWebRequest www = UnityWebRequest.Post(Url, loginForm);
        yield return www.SendWebRequest();

        if (www.isDone)
        {
            var result = www.downloadHandler.text;

            Debug.Log(result);

            if (result != "0")
            {
                UserProperty user = new UserProperty();
                user = JsonUtility.FromJson<UserProperty>(result);

                PlayerPrefs.SetString("Id pengguna", user.idpengguna);

                Debug.Log("Id saya ialah : " + user.idpengguna);
                SceneManager.LoadScene(1);

            }

            else
            {
                Debug.Log("Id Pengguna Yang Dimasukkan Tidak Betul");
            }
        }

    }

}

 

